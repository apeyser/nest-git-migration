language: cpp
compiler: gcc

cache:
- ccache
- apt

env:
  matrix:
  - xGSL=o xMPI=o xPYTHON=x

matrix:
  fast_finish: true

before_install:
  - echo $LANG
  - echo $LC_ALL
  - >
    sudo apt-get install -y
    libboost-thread-dev libboost-system-dev libboost-test-dev
    python3 python3-all-dev python3-dev ipython3
    python-tk python-imaging python-imaging-tk
    coreutils gawk mawk original-awk
    devscripts build-essential
    texlive-latex-extra
    clang indent
    openmpi-dev openmpi-bin openmpi-doc libopenmpi-dev
    texlive texlive-latex-base texlive-latex3 ghostscript
    autoconf automake libtool libltdl-dev
    libgsl0-dev  libghc-readline-dev gsl-bin libgsl0-dbg libgsl0ldbl
    git-svn cvs
    e2fsprogs gettext libpackagekit-glib2-dev groff libssh2-1-dev
    slang-gsl libncurses5-dev check
    clang-format-3.4
    cppcheck
  - sudo apt-get autoremove
  - >
    pip install python-debian numpy scipy virtualenv matplotlib coverage
    nose setuptools mpi4py django django-tagging httplib2 simplejson svn
    cheetah jinja2 mock gmpy libssh2
  - >
    pip3 install numpy scipy nose
  - sudo curl -L "http://google-styleguide.googlecode.com/svn/trunk/cpplint/cpplint.py" -o /usr/bin/cpplint.py
  - sudo chmod a+x /usr/bin/cpplint.py
  - sudo ln -s /usr/bin/clang-format-3.4 /usr/bin/clang-format
  - clang-format -style=llvm -dump-config > .clang-format
  - cppcheck --version

script: ./build.sh

after_failure:
  - cd $TRAVIS_BUILD_DIR/build
  - |
    for i in $(find reports -type f); do
      echo "###########################"
      echo "File: $i"
      cat $i
    done

notifications:
  email:
    recipients:
    - a.peyser@fz-juelich.de
    on_success: change
    on_failure: always
