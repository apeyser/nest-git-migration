language: cpp
compiler: gcc

cache:
- ccache
- apt

env:
  matrix:
  - xGSL=o xMPI=o xPYTHON=o
  - xGSL=o xMPI=o xPYTHON=x
  - xGSL=o xMPI=x xPYTHON=o
  - xGSL=o xMPI=x xPYTHON=x
  - xGSL=x xMPI=o xPYTHON=o
  - xGSL=x xMPI=o xPYTHON=x
  - xGSL=x xMPI=x xPYTHON=o
  - xGSL=x xMPI=x xPYTHON=x

matrix:
  fast_finish: true

before_install:
  - echo $LANG
  - echo $LC_ALL
  - sudo apt-get update -qq
  - >
    sudo apt-get install -y
    libboost-thread-dev libboost-system-dev libboost-test-dev
    python3 ipython3 coreutils gawk mawk original-awk
    devscripts build-essential
    texlive-latex-extra
    clang indent
    python-debian python-numpy python-scipy python-virtualenv python-matplotlib python-tk
    python-coverage python-nose python-setuptools
    python-mpi4py openmpi-dev openmpi-bin openmpi-doc libopenmpi-dev
    python3 python3-all-dev python3-dev python3-numpy python3-scipy python3-nose cython
    texlive texlive-latex-base texlive-latex3 ghostscript
    autoconf automake libtool libltdl-dev
    libgsl0-dev  libghc-readline-dev gsl-bin libgsl0-dbg libgsl0ldbl
    python-django python-django-tagging python-httplib2 python-simplejson python-svn git-svn
    python-cheetah python-jinja2 python-mock
    python-tk python-gmpy python-imaging python-imaging-tk
    cvs e2fsprogs gettext libpackagekit-glib2-dev groff libssh2-1-dev python-libssh2 slang-gsl libncurses5-dev check
    clang-format-3.4
    cppcheck
  - sudo apt-get autoremove
  - sudo curl -L "http://google-styleguide.googlecode.com/svn/trunk/cpplint/cpplint.py" -o /usr/bin/cpplint.py
  - sudo chmod a+x /usr/bin/cpplint.py
  - sudo ln -s /usr/bin/clang-format-3.4 /usr/bin/clang-format
  - clang-format -style=llvm -dump-config > .clang-format
  - cppcheck --version

script: ./build.sh

after_failure: |
  (
    cd $TRAVIS_BUILD_DIR/build
    for i in $(find reports -type f); do
      echo "###########################"
      echo "File: $i"
      cat $i
    done
  )

notifications:
  email:
    recipients:
    - a.peyser@fz-juelich.de
    on_success: change
    on_failure: always
