language: cpp
compiler: gcc
cache: 
- ccache
- apt

before_install:
- echo $LANG
- echo $LC_ALL
- if [ $TRAVIS_OS_NAME == linux ]; then sudo apt-get update && sudo apt-get install
  -y llvm-3.4 llvm-3.4-dev; fi
- sudo apt-get install -y python3 ipython3 coreutils gawk mawk original-awk
- sudo apt-get install -y devscripts build-essential
- sudo apt-get install -y texlive-latex-extra
- sudo apt-get install -y clang indent
- sudo apt-get install -y python-debian python-numpy python-scipy python-virtualenv
  python-matplotlib python-tk
- sudo apt-get install -y python-coverage python-nose python-setuptools
- sudo apt-get install -y python-mpi4py openmpi-dev openmpi-bin
- sudo apt-get install -y python3 python3-all-dev python3-dev python3-numpy python3-scipy
  python3-nose cython
- sudo apt-get install -y texlive texlive-latex-base texlive-latex3 ghostscript
- sudo apt-get install -y autoconf automake libtool libltdl-dev
- sudo apt-get install -y libgsl0-dev  libghc-readline-dev
- sudo apt-get install -y python-django python-django-tagging python-httplib2 python-simplejson
  python-svn git-svn
- sudo apt-get install -y python-cheetah python-jinja2 python-mock
- sudo apt-get install -y python-tk python-gmpy python-imaging python-imaging-tk
- sudo apt-get install -y python
- sudo apt-get install -y cvs e2fsprogs gettext libpackagekit-glib2-dev groff libssh2-1-dev
  python-libssh2 slang-gsl libncurses5-dev check

before_script: chmod +x build.sh
script: ./build.sh

notifications:
  email:
    recipients:
      - a.peyser@fz-juelich.de
    on_success: change
    on_failure: always

deploy:
  provider: releases
  api_key:
    secure: bpwv/Rn6mtXR67OdApRvh9dCKCMW1X5tKKZbbxZneaO2uVjG/pWn445BZn9NzC1KhKCcbbLpYc0ECH/FC7bwVSKBD1wDvwncyheWbEqnLLtbRSNOZBTsNypJTeZwHekxzCmimWvZEVD2d0PSjsy7GhYrnmBoaioSg8qtsauK8nk=
  file:
    - reports/installcheck.log
    - reports/pynest_tests.xml
    - reports/TEST-core.phase_1.xml
    - reports/TEST-core.phase_2.xml
    - reports/TEST-core.phase_3.xml
    - reports/TEST-core.phase_4.xml
    - reports/TEST-core.phase_5.xml
  skip_cleanup: true
  on:
    repo: apeyser/nest-git-migration
    tags: true
